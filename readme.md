see slides for details. code for my own reference.
